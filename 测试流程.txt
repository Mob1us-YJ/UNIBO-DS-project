ä¸‹é¢ç»™å‡ºä¸€ä¸ªå®Œæ•´çš„ snippets æµ‹è¯•æ¡ˆä¾‹ï¼Œç”¨äºéªŒè¯å¤šäººæ¸¸æˆæµç¨‹ï¼ˆåŒ…æ‹¬æ³¨å†Œã€ç™»å½•ã€åˆ›å»ºæˆ¿é—´ã€åŠ å…¥æˆ¿é—´ã€é¡ºåºè½®æµå«æ•°ç­‰ï¼‰ã€‚å‡è®¾ä½ çš„æœåŠ¡å™¨ç«¯ä»£ç åœ¨  
`snippets.lab4.example2_rpc_server`ï¼ˆä½¿ç”¨ `-l 4 -e 2` å¯åŠ¨ï¼‰ï¼Œ  
è€Œå®¢æˆ·ç«¯ä»£ç åœ¨  
`snippets.lab4.example4_rpc_client_cli`ï¼ˆä½¿ç”¨ `-l 4 -e 4` å¯åŠ¨ï¼‰ã€‚

---

### 1. å¯åŠ¨æœåŠ¡å™¨

åœ¨ç»ˆç«¯ä¸­æ‰§è¡Œï¼š

```bash
python -m snippets -l 4 -e 2 8080
```

**é¢„æœŸè¾“å‡ºç¤ºä¾‹**ï¼š

```
# Running module snippets.lab4.example2_rpc_server from ...
MindRoll Server is running with a minimal register <username> <password> approach and sequential turn calling.
MindRoll Server listening on 0.0.0.0:8080
```

æ­¤æ—¶æœåŠ¡å™¨æ­£åœ¨ç«¯å£ 8080 ç›‘å¬å®¢æˆ·ç«¯è¿æ¥ã€‚

---

### 2. ç©å®¶1æ“ä½œ

#### 2.1 å¯åŠ¨ç©å®¶1å®¢æˆ·ç«¯

åœ¨å¦ä¸€ä¸ªç»ˆç«¯ä¸­æ‰§è¡Œï¼š

```bash
python -m snippets -l 4 -e 4 127.0.0.1 8080 register
```

**é¢„æœŸè¾“å‡º**ï¼ˆè¿›å…¥äº¤äº’å¼å‘½ä»¤è¡Œï¼‰ï¼š

```
# Running module snippets.lab4.example4_rpc_client_cli from ...
=== MindRoll Client Ready ===
Available commands:
  register <user> <pass>
  login <user> <pass>
  create_room <room>
  join_room <room> <user>
  call_number <room> <user> <number>
  reveal_result <room> <user>
  get_game_state <room>
  load_token <file>
  exit
```

#### 2.2 æ³¨å†Œç©å®¶1

åœ¨å®¢æˆ·ç«¯å‘½ä»¤æç¤ºç¬¦ä¸‹è¾“å…¥ï¼š

```
register player1 p1pass
```

**é¢„æœŸè¾“å‡º**ï¼š

```
Enter command: register player1 p1pass
ğŸ“¤ Sending request: {"name":"register","args":["player1","p1pass"],"metadata":{}}
ğŸ“¥ Received response: {"result":"Register success for player1","error":null}
âœ… Response: Register success for player1
```

#### 2.3 ç™»å½•ç©å®¶1

è¾“å…¥ï¼š

```
login player1 p1pass
```

**é¢„æœŸè¾“å‡º**ï¼ˆtoken ä¸ºç¤ºä¾‹å­—ç¬¦ä¸²ï¼‰ï¼š

```
Enter command: login player1 p1pass
ğŸ“¤ Sending request: {"name":"login","args":["player1","p1pass"],"metadata":{}}
ğŸ“¥ Received response: {"result":{"token":"abc123-token"},"error":null}
âœ… Response: {"token": "abc123-token"}
âœ… Logged in! token=abc123-token
```

æ­¤æ—¶ç©å®¶1çš„å®¢æˆ·ç«¯ä¿å­˜äº† tokenã€‚

#### 2.4 åˆ›å»ºæˆ¿é—´

è¾“å…¥ï¼š

```
create_room room1
```

**é¢„æœŸè¾“å‡º**ï¼š

```
Enter command: create_room room1
ğŸ“¤ Sending request: {"name":"create_room","args":["room1"],"metadata":{"token":{"token":"abc123-token"}}}
ğŸ“¥ Received response: {"result":"Room room1 created successfully","error":null}
âœ… Response: Room room1 created successfully
```

#### 2.5 ç©å®¶1åŠ å…¥æˆ¿é—´

è¾“å…¥ï¼š

```
join_room room1 player1
```

**é¢„æœŸè¾“å‡º**ï¼ˆæœåŠ¡å™¨åˆ†é…ä¸€ä¸ªéª°å­ï¼‰ï¼š

```
Enter command: join_room room1 player1
ğŸ“¤ Sending request: {"name":"join_room","args":["room1","player1"],"metadata":{"token":{"token":"abc123-token"}}}
ğŸ“¥ Received response: {"result":"player1 joined room room1, dice: 4 red","error":null}
âœ… Response: player1 joined room room1, dice: 4 red
```

---

### 3. ç©å®¶2æ“ä½œ

#### 3.1 å¯åŠ¨ç©å®¶2å®¢æˆ·ç«¯

åœ¨ç¬¬ä¸‰ä¸ªç»ˆç«¯ä¸­æ‰§è¡Œï¼š

```bash
python -m snippets -l 4 -e 4 127.0.0.1 8080 register
```

**é¢„æœŸè¾“å‡º**åŒä¸Šï¼Œè¿›å…¥äº¤äº’å‘½ä»¤è¡Œã€‚

#### 3.2 æ³¨å†Œç©å®¶2

è¾“å…¥ï¼š

```
register player2 p2pass
```

**é¢„æœŸè¾“å‡º**ï¼š

```
Enter command: register player2 p2pass
ğŸ“¤ Sending request: {"name":"register","args":["player2","p2pass"],"metadata":{}}
ğŸ“¥ Received response: {"result":"Register success for player2","error":null}
âœ… Response: Register success for player2
```

#### 3.3 ç™»å½•ç©å®¶2

è¾“å…¥ï¼š

```
login player2 p2pass
```

**é¢„æœŸè¾“å‡º**ï¼ˆtoken ä¸ºç¤ºä¾‹å­—ç¬¦ä¸²ï¼‰ï¼š

```
Enter command: login player2 p2pass
ğŸ“¤ Sending request: {"name":"login","args":["player2","p2pass"],"metadata":{}}
ğŸ“¥ Received response: {"result":{"token":"def456-token"},"error":null}
âœ… Response: {"token": "def456-token"}
âœ… Logged in! token=def456-token
```

#### 3.4 ç©å®¶2åŠ å…¥æˆ¿é—´

è¾“å…¥ï¼š

```
join_room room1 player2
```

**é¢„æœŸè¾“å‡º**ï¼ˆæ­¤æ—¶æœåŠ¡å™¨åœ¨ `room1` ä¸­è®°å½•ç©å®¶é¡ºåºï¼‰ï¼š

```
Enter command: join_room room1 player2
ğŸ“¤ Sending request: {"name":"join_room","args":["room1","player2"],"metadata":{"token":{"token":"def456-token"}}}
ğŸ“¥ Received response: {"result":"player2 joined room room1, dice: 6 blue","error":null}
âœ… Response: player2 joined room room1, dice: 6 blue
```

ç©å®¶2æˆåŠŸåŠ å…¥æˆ¿é—´ï¼Œä¸”å…¶åŠ å…¥é¡ºåºä¼šè¢«è®°å½•åœ¨ `players_order` ä¸­ã€‚

---

### 4. æ¸¸æˆè½®æµå«æ•°

#### 4.1 ç©å®¶1å«æ•°

åœ¨ç©å®¶1å®¢æˆ·ç«¯è¾“å…¥ï¼š

```
call_number room1 player1 10
```

**é¢„æœŸè¾“å‡º**ï¼š

```
Enter command: call_number room1 player1 10
ğŸ“¤ Sending request: {"name":"call_number","args":["room1","player1","10"],"metadata":{"token":{"token":"abc123-token"}}}
ğŸ“¥ Received response: {"result":"player1 called 10, next turn: player2","error":null}
âœ… Response: player1 called 10, next turn: player2
```

æ­¤æ—¶è½®åˆ°ç©å®¶2ã€‚

#### 4.2 ç©å®¶2å«æ•°

åœ¨ç©å®¶2å®¢æˆ·ç«¯è¾“å…¥ï¼š

```
call_number room1 player2 12
```

**é¢„æœŸè¾“å‡º**ï¼š

```
Enter command: call_number room1 player2 12
ğŸ“¤ Sending request: {"name":"call_number","args":["room1","player2","12"],"metadata":{"token":{"token":"def456-token"}}}
ğŸ“¥ Received response: {"result":"player2 called 12, next turn: player1","error":null}
âœ… Response: player2 called 12, next turn: player1
```

è½®åˆ°ç©å®¶1ã€‚

#### 4.3 å†è½®åˆ°ç©å®¶1å«æ•°

åœ¨ç©å®¶1å®¢æˆ·ç«¯è¾“å…¥ï¼š

```
call_number room1 player1 15
```

**é¢„æœŸè¾“å‡º**ï¼š

```
Enter command: call_number room1 player1 15
ğŸ“¤ Sending request: {"name":"call_number","args":["room1","player1","15"],"metadata":{"token":{"token":"abc123-token"}}}
ğŸ“¥ Received response: {"result":"player1 called 15, next turn: player2","error":null}
âœ… Response: player1 called 15, next turn: player2
```

å¦‚æ­¤ï¼Œç©å®¶1å’Œç©å®¶2å°†ä¾æ¬¡è½®æµå«æ•°ï¼Œé¡ºåºç”± `players_order` æ¥æ§åˆ¶ã€‚

---

### 5. å…¬å¸ƒç»“æœ

å‡è®¾ç”±ç©å®¶2æ¥å…¬å¸ƒç»“æœï¼Œåœ¨ç©å®¶2å®¢æˆ·ç«¯è¾“å…¥ï¼š

```
reveal_result room1 player2
```

**é¢„æœŸè¾“å‡º**ï¼ˆæœåŠ¡å™¨æ ¹æ®è§„åˆ™åˆ¤å®šèƒœè´Ÿï¼Œç¤ºä¾‹è¾“å‡ºï¼‰ï¼š

```
Enter command: reveal_result room1 player2
ğŸ“¤ Sending request: {"name":"reveal_result","args":["room1","player2"],"metadata":{"token":{"token":"def456-token"}}}
ğŸ“¥ Received response: {"result":"player2 wins! Now score= 1","error":null}
âœ… Response: player2 wins! Now score= 1
```

æœåŠ¡å™¨æ ¹æ®æ‰€æœ‰ç©å®¶çš„éª°å­ç‚¹æ•°ã€é¢œè‰²ã€å½“å‰å«æ•°è®¡ç®—å‡ºèƒœè´Ÿï¼Œå¹¶æ›´æ–°ç©å®¶åˆ†æ•°ã€‚

---

### 6. æŸ¥çœ‹æˆ¿é—´çŠ¶æ€

åœ¨ä»»ä¸€å®¢æˆ·ç«¯è¾“å…¥ï¼š

```
get_game_state room1
```

**é¢„æœŸè¾“å‡º**ï¼ˆæ˜¾ç¤ºæˆ¿é—´æ‰€æœ‰ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç©å®¶ä¿¡æ¯ã€é¡ºåºã€å½“å‰è½®æ¬¡ã€å«æ•°ç­‰ï¼‰ï¼š

```
Enter command: get_game_state room1
ğŸ“¤ Sending request: {"name":"get_game_state","args":["room1"],"metadata":{"token":{"token":"abc123-token"}}}
ğŸ“¥ Received response: {"result": {"players": {"player1": {"dice_number":4, "dice_color":"red", "score":0}, "player2": {"dice_number":6, "dice_color":"blue", "score":1}}, "players_order": ["player1", "player2"], "current_turn": "player1", "called_number": 15, "winner": "player2"}, "error": null}
âœ… Response: { ... } 
```

---

### 7. é€€å‡ºå®¢æˆ·ç«¯

åœ¨å„ä¸ªå®¢æˆ·ç«¯è¾“å…¥ `exit`ï¼Œé€€å‡ºäº¤äº’å¼å‘½ä»¤è¡Œã€‚æœåŠ¡å™¨ä»ç»§ç»­è¿è¡Œï¼Œç­‰å¾…å…¶å®ƒè¿æ¥æˆ–å¯é€šè¿‡ Ctrl+C ç»ˆæ­¢æœåŠ¡å™¨è¿›ç¨‹ã€‚

---

## **æ€»ç»“**

å®Œæ•´çš„ snippets æµ‹è¯•æ¡ˆä¾‹æµç¨‹å¦‚ä¸‹ï¼š

1. **å¯åŠ¨æœåŠ¡å™¨**ï¼š
   ```bash
   python -m snippets -l 4 -e 2 8080
   ```
2. **ç©å®¶1**ï¼ˆåœ¨ç»ˆç«¯2ï¼‰ï¼š
   - å¯åŠ¨å®¢æˆ·ç«¯ï¼š
     ```bash
     python -m snippets -l 4 -e 4 127.0.0.1 8080 register
     ```
   - æ‰§è¡Œï¼š
     ```
     register player1 p1pass
     login player1 p1pass
     create_room room1
     join_room room1 player1
     call_number room1 player1 10
     call_number room1 player1 15
     ```
3. **ç©å®¶2**ï¼ˆåœ¨ç»ˆç«¯3ï¼‰ï¼š
   - å¯åŠ¨å®¢æˆ·ç«¯ï¼š
     ```bash
     python -m snippets -l 4 -e 4 127.0.0.1 8080 register
     ```
   - æ‰§è¡Œï¼š
     ```
     register player2 p2pass
     login player2 p2pass
     join_room room1 player2
     call_number room1 player2 12
     reveal_result room1 player2
     ```
4. **æŸ¥çœ‹æˆ¿é—´çŠ¶æ€**ï¼š
   åœ¨ä»»ä¸€å®¢æˆ·ç«¯è¾“å…¥ï¼š
   ```
   get_game_state room1
   ```
5. **é€€å‡º**ï¼š
   è¾“å…¥ `exit` é€€å‡ºå®¢æˆ·ç«¯ã€‚

é€šè¿‡ä»¥ä¸Šæ­¥éª¤ï¼Œä½ å°±å¯ä»¥éªŒè¯ï¼š  
- ç”¨æˆ·å¯ä»¥å…ˆæ³¨å†Œã€ç™»å½•ï¼›  
- æˆ¿é—´åˆ›å»ºåï¼Œä¸¤ä¸ªç©å®¶ä¾ç…§åŠ å…¥é¡ºåºè½®æµå«æ•°ï¼›  
- æ¸¸æˆç»“æŸæ—¶å…¬å¸ƒç»“æœï¼Œå¹¶èƒ½æŸ¥è¯¢æˆ¿é—´çŠ¶æ€ã€‚  

è¿™å°±æ˜¯ä¸€ä¸ªå®Œæ•´çš„ snippets æµ‹è¯•æ¡ˆä¾‹ã€‚